# 提案書

## 題目方向

Cipher Game Pro Max - 企業(組織)內部通訊平台

## 動機與背景

我們選擇以純文字訊息為通訊內容，主要是考量文字資料的檔案較小，傳輸與儲存相對容易管理，對系統實作較為友善。而如影像或檔案傳輸則涉及更複雜的儲存機制與完整性驗證，因此暫不納入範疇。

此外，企業內部通訊常包含敏感資訊，我們認為應避免將訊息委由第三方服務（如 Telegram）處理，以防資料在外部伺服器中暴露風險。因此，我們希望打造一個由企業自主管理與維護的通訊平台，提升整體安全性與可控性。

## 問題定義與目標

本專案旨在模擬企業等級的安全文字通訊系統，設計一個模組化、可擴展且具備彈性的金鑰管理系統（KMS），以實現訊息保密性與存取控制的最高標準。此系統將維持信封加密模型的完整性，確保訊息內容透過臨時生成的資料金鑰（DEK）進行保護，而每個 DEK 皆由客戶主金鑰（CMK）進行加密包裝，使資料與金鑰分離的安全策略得以實現。

為了進一步提升安全性與可控性，我們將支援細緻化的角色型權限管理機制，讓不同職能角色如一般使用者、系統管理員與稽核人員僅能執行其授權範疇內的操作。此外，系統將內建有效的金鑰輪替與重包裝功能，不僅符合前向安全性原則，也能在主金鑰更新時動態保護現有資料，無須重新加密訊息本身。

我們採用模擬 HSM 行為的集中式金鑰生命週期設計，所有金鑰產生、加密、解密與操作記錄皆在模擬的可信執行環境內完成，主金鑰永不暴露於外部服務或使用者端。此機制不僅模擬實體 HSM 的操作邏輯與不可匯出策略，亦配合加密雜湊鏈構成完整的操作日誌，強化稽核可驗證性並防範資料竄改。

整體設計將以企業實務需求為導向，並兼顧安全性、合規性、可用性與操作便利性，讓此系統在模擬企業內部真實應用場景時，能有效支持高強度安全通訊需求與動態使用者存取行為。

## 主要特點

- 信封加密：每則訊息或會話產生對稱 DEK，並以 CMK 包裝，保障訊息機密性與動態存取控制。
- 模擬 HSM 行為：CMK 僅用於內部金鑰操作，模擬 AWS/GCP 等企業級 KMS 實務。
- 角色式存取控制 (RBAC)：金鑰操作依據使用者角色（user、admin、auditor）授權驗證 [1, 2]。
- 防竄改稽核：以密碼雜湊鏈構建可驗證、不可修改的日誌。
- 金鑰輪替與重包裝：支援 CMK 輪替並重新包裝既有 DEK，無需重新加密訊息即可維持安全性。
- 多收件人訊息傳遞：每位收件人各自擁有包裝的 DEK，支援彈性撤銷與分發控制。

## 預期成果

- 模擬企業級安全訊息系統（信封加密、KMS）
- 資料與金鑰分離達成零信任要求
- 高安全性（防竄改稽核、不可匯出金鑰）
- 可擴展、多使用者多收件者的訊息工作流（具前向安全性）
